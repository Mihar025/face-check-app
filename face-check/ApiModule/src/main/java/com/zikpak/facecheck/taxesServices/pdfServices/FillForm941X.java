package com.zikpak.facecheck.taxesServices.pdfServices;

import com.itextpdf.forms.PdfAcroForm;
import com.itextpdf.forms.fields.PdfFormField;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfReader;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.zikpak.facecheck.repository.CompanyRepository;
import com.zikpak.facecheck.repository.EmployerTaxRecordRepository;
import com.zikpak.facecheck.repository.UserRepository;
import com.zikpak.facecheck.taxesServices.services.PaymentHistoryService;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.io.IOException;
import java.util.Map;
import java.util.stream.Collectors;

@Service
@RequiredArgsConstructor
public class FillForm941X {
    private final UserRepository userRepository;
    private final CompanyRepository companyRepository;
    private final EmployerTaxRecordRepository taxRecordRepo;
    private final PaymentHistoryService paymentHistoryService;

    public void generateFilledPdf() throws IOException {
        String src = "/Users/mishamaydanskiy/face-check-app/face-check/ApiModule/src/main/resources/forms/f941x.pdf";
        String dest = "filled_f941x_output.pdf";

        PdfReader reader = new PdfReader(src);
        PdfWriter writer = new PdfWriter(dest);
        PdfDocument pdfDoc = new PdfDocument(reader, writer);

        PdfAcroForm form = PdfAcroForm.getAcroForm(pdfDoc, true);
        Map<String, PdfFormField> fields = form.getFormFields();

        System.out.println("==== Список полей формы ====");
        for (String fieldName : fields.keySet()) {
            System.out.println(fieldName);
        }


        fill(fields, "topmostSubform[0]", "1");
        fill(fields, "topmostSubform[0].Page1[0]", "2");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0]", "3");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_1[0]", "4");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_2[0]", "5");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_3[0]", "6");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_4[0]", "7");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_5[0]", "8");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_6[0]", "9");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_7[0]", "10");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_8[0]", "11");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_9[0]", "12");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_10[0]", "13");
        fill(fields, "topmostSubform[0].Page1[0].Entity[0].f1_11[0]", "14");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0]", "15");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].c1_1[0]", "16");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].c1_1[1]", "17");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].c1_2[0]", "18");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].c1_2[1]", "19");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].c1_2[2]", "20");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].c1_2[3]", "21");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].f1_12[0]", "22");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].f1_13[0]", "23");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].f1_14[0]", "24");
        fill(fields, "topmostSubform[0].Page1[0].SideBoxes[0].f1_15[0]", "25");
        fill(fields, "topmostSubform[0].Page1[0].c1_3[0]", "26");
        fill(fields, "topmostSubform[0].Page1[0].c1_3[1]", "27");
        fill(fields, "topmostSubform[0].Page1[0].c1_4[0]", "28");
        fill(fields, "topmostSubform[0].Page1[0].c1_5[0]", "29");
        fill(fields, "topmostSubform[0].Page1[0].c1_6[0]", "30");
        fill(fields, "topmostSubform[0].Page1[0].c1_7[0]", "31");
        fill(fields, "topmostSubform[0].Page1[0].c1_8[0]", "32");
        fill(fields, "topmostSubform[0].Page1[0].c1_9[0]", "33");
        fill(fields, "topmostSubform[0].Page1[0].c1_10[0]", "34");
        fill(fields, "topmostSubform[0].Page1[0].c1_11[0]", "35");
        fill(fields, "topmostSubform[0].Page2[0]", "36");
        fill(fields, "topmostSubform[0].Page2[0].Name_ReadOrder[0]", "37");
        fill(fields, "topmostSubform[0].Page2[0].Name_ReadOrder[0].f1_3[0]", "38");
        fill(fields, "topmostSubform[0].Page2[0].EIN_ReadOrder[0]", "39");
        fill(fields, "topmostSubform[0].Page2[0].EIN_ReadOrder[0].f1_1[0]", "40");
        fill(fields, "topmostSubform[0].Page2[0].EIN_ReadOrder[0].f1_2[0]", "41");
        fill(fields, "topmostSubform[0].Page2[0].f2_1[0]", "42");
        fill(fields, "topmostSubform[0].Page2[0].f1_12[0]", "43");
        fill(fields, "topmostSubform[0].Page2[0].f2_2[0]", "44");
        fill(fields, "topmostSubform[0].Page2[0].f2_3[0]", "45");
        fill(fields, "topmostSubform[0].Page2[0].f2_4[0]", "46");
        fill(fields, "topmostSubform[0].Page2[0].f2_5[0]", "47");
        fill(fields, "topmostSubform[0].Page2[0].f2_6[0]", "48");
        fill(fields, "topmostSubform[0].Page2[0].f2_7[0]", "49");
        fill(fields, "topmostSubform[0].Page2[0].f2_8[0]", "50");
        fill(fields, "topmostSubform[0].Page2[0].f2_9[0]", "51");
        fill(fields, "topmostSubform[0].Page2[0].f2_10[0]", "52");
        fill(fields, "topmostSubform[0].Page2[0].f2_11[0]", "53");
        fill(fields, "topmostSubform[0].Page2[0].f2_12[0]", "54");
        fill(fields, "topmostSubform[0].Page2[0].f2_13[0]", "55");
        fill(fields, "topmostSubform[0].Page2[0].f2_14[0]", "56");
        fill(fields, "topmostSubform[0].Page2[0].f2_15[0]", "57");
        fill(fields, "topmostSubform[0].Page2[0].f2_16[0]", "58");
        fill(fields, "topmostSubform[0].Page2[0].f2_17[0]", "59");
        fill(fields, "topmostSubform[0].Page2[0].f2_18[0]", "60");
        fill(fields, "topmostSubform[0].Page2[0].f2_19[0]", "61");
        fill(fields, "topmostSubform[0].Page2[0].f2_20[0]", "62");
        fill(fields, "topmostSubform[0].Page2[0].f2_21[0]", "63");
        fill(fields, "topmostSubform[0].Page2[0].f2_22[0]", "64");
        fill(fields, "topmostSubform[0].Page2[0].f2_23[0]", "65");
        fill(fields, "topmostSubform[0].Page2[0].f2_24[0]", "66");
        fill(fields, "topmostSubform[0].Page2[0].f2_25[0]", "67");
        fill(fields, "topmostSubform[0].Page2[0].f2_26[0]", "68");
        fill(fields, "topmostSubform[0].Page2[0].f2_27[0]", "69");
        fill(fields, "topmostSubform[0].Page2[0].f2_28[0]", "70");
        fill(fields, "topmostSubform[0].Page2[0].f2_29[0]", "71");
        fill(fields, "topmostSubform[0].Page2[0].f2_30[0]", "72");
        fill(fields, "topmostSubform[0].Page2[0].f2_31[0]", "73");
        fill(fields, "topmostSubform[0].Page2[0].f2_32[0]", "74");
        fill(fields, "topmostSubform[0].Page2[0].f2_33[0]", "75");
        fill(fields, "topmostSubform[0].Page2[0].f2_34[0]", "76");
        fill(fields, "topmostSubform[0].Page2[0].f2_35[0]", "77");
        fill(fields, "topmostSubform[0].Page2[0].f2_36[0]", "78");
        fill(fields, "topmostSubform[0].Page2[0].f2_37[0]", "79");
        fill(fields, "topmostSubform[0].Page2[0].f2_38[0]", "80");
        fill(fields, "topmostSubform[0].Page2[0].f2_39[0]", "81");
        fill(fields, "topmostSubform[0].Page2[0].f2_40[0]", "82");
        fill(fields, "topmostSubform[0].Page2[0].f2_41[0]", "83");
        fill(fields, "topmostSubform[0].Page2[0].f2_42[0]", "84");
        fill(fields, "topmostSubform[0].Page2[0].f2_43[0]", "85");
        fill(fields, "topmostSubform[0].Page2[0].f2_44[0]", "86");
        fill(fields, "topmostSubform[0].Page2[0].f2_45[0]", "87");
        fill(fields, "topmostSubform[0].Page2[0].f2_46[0]", "88");
        fill(fields, "topmostSubform[0].Page2[0].f2_47[0]", "89");
        fill(fields, "topmostSubform[0].Page2[0].f2_48[0]", "90");
        fill(fields, "topmostSubform[0].Page2[0].f2_49[0]", "91");
        fill(fields, "topmostSubform[0].Page2[0].f2_50[0]", "92");
        fill(fields, "topmostSubform[0].Page2[0].f2_51[0]", "93");
        fill(fields, "topmostSubform[0].Page2[0].f2_52[0]", "94");
        fill(fields, "topmostSubform[0].Page2[0].f2_53[0]", "95");
        fill(fields, "topmostSubform[0].Page2[0].f2_54[0]", "96");
        fill(fields, "topmostSubform[0].Page2[0].f2_55[0]", "97");
        fill(fields, "topmostSubform[0].Page2[0].f2_56[0]", "98");
        fill(fields, "topmostSubform[0].Page2[0].f2_57[0]", "99");
        fill(fields, "topmostSubform[0].Page2[0].f2_58[0]", "100");
        fill(fields, "topmostSubform[0].Page2[0].f2_59[0]", "101");
        fill(fields, "topmostSubform[0].Page2[0].f2_60[0]", "102");
        fill(fields, "topmostSubform[0].Page2[0].f2_61[0]", "103");
        fill(fields, "topmostSubform[0].Page2[0].f2_62[0]", "104");
        fill(fields, "topmostSubform[0].Page2[0].f2_63[0]", "105");
        fill(fields, "topmostSubform[0].Page2[0].f2_64[0]", "106");
        fill(fields, "topmostSubform[0].Page2[0].f2_65[0]", "107");
        fill(fields, "topmostSubform[0].Page2[0].f2_66[0]", "108");
        fill(fields, "topmostSubform[0].Page2[0].f2_67[0]", "109");
        fill(fields, "topmostSubform[0].Page2[0].f2_68[0]", "110");
        fill(fields, "topmostSubform[0].Page2[0].f2_69[0]", "111");
        fill(fields, "topmostSubform[0].Page2[0].f2_70[0]", "112");
        fill(fields, "topmostSubform[0].Page2[0].f2_71[0]", "113");
        fill(fields, "topmostSubform[0].Page2[0].f2_72[0]", "114");
        fill(fields, "topmostSubform[0].Page2[0].f2_73[0]", "115");
        fill(fields, "topmostSubform[0].Page2[0].f2_74[0]", "116");
        fill(fields, "topmostSubform[0].Page2[0].f2_75[0]", "117");
        fill(fields, "topmostSubform[0].Page2[0].f2_76[0]", "118");
        fill(fields, "topmostSubform[0].Page2[0].f2_77[0]", "119");
        fill(fields, "topmostSubform[0].Page2[0].f2_78[0]", "120");
        fill(fields, "topmostSubform[0].Page2[0].f2_79[0]", "121");
        fill(fields, "topmostSubform[0].Page2[0].f2_80[0]", "122");
        fill(fields, "topmostSubform[0].Page2[0].f2_81[0]", "123");
        fill(fields, "topmostSubform[0].Page2[0].f2_82[0]", "124");
        fill(fields, "topmostSubform[0].Page2[0].f2_83[0]", "125");
        fill(fields, "topmostSubform[0].Page2[0].f2_84[0]", "126");
        fill(fields, "topmostSubform[0].Page2[0].f2_85[0]", "127");
        fill(fields, "topmostSubform[0].Page2[0].f2_86[0]", "128");
        fill(fields, "topmostSubform[0].Page2[0].f2_87[0]", "129");
        fill(fields, "topmostSubform[0].Page2[0].f2_88[0]", "130");
        fill(fields, "topmostSubform[0].Page2[0].f2_89[0]", "131");
        fill(fields, "topmostSubform[0].Page2[0].f2_90[0]", "132");
        fill(fields, "topmostSubform[0].Page2[0].f2_91[0]", "133");
        fill(fields, "topmostSubform[0].Page2[0].f2_92[0]", "134");
        fill(fields, "topmostSubform[0].Page2[0].f2_93[0]", "135");
        fill(fields, "topmostSubform[0].Page2[0].f2_94[0]", "136");
        fill(fields, "topmostSubform[0].Page2[0].f2_95[0]", "137");
        fill(fields, "topmostSubform[0].Page2[0].f2_96[0]", "138");
        fill(fields, "topmostSubform[0].Page2[0].f2_97[0]", "139");
        fill(fields, "topmostSubform[0].Page2[0].f2_98[0]", "140");
        fill(fields, "topmostSubform[0].Page2[0].f2_99[0]", "141");
        fill(fields, "topmostSubform[0].Page2[0].f2_100[0]", "142");
        fill(fields, "topmostSubform[0].Page2[0].f2_101[0]", "143");
        fill(fields, "topmostSubform[0].Page2[0].f2_102[0]", "144");
        fill(fields, "topmostSubform[0].Page2[0].f2_103[0]", "145");
        fill(fields, "topmostSubform[0].Page2[0].f2_104[0]", "146");
        fill(fields, "topmostSubform[0].Page2[0].f2_105[0]", "147");
        fill(fields, "topmostSubform[0].Page2[0].f2_106[0]", "148");
        fill(fields, "topmostSubform[0].Page2[0].f2_107[0]", "149");
        fill(fields, "topmostSubform[0].Page2[0].f2_108[0]", "150");
        fill(fields, "topmostSubform[0].Page2[0].f2_109[0]", "151");
        fill(fields, "topmostSubform[0].Page2[0].f2_110[0]", "152");
        fill(fields, "topmostSubform[0].Page2[0].f2_111[0]", "153");
        fill(fields, "topmostSubform[0].Page2[0].f2_112[0]", "154");
        fill(fields, "topmostSubform[0].Page2[0].f2_113[0]", "155");
        fill(fields, "topmostSubform[0].Page2[0].f2_114[0]", "156");
        fill(fields, "topmostSubform[0].Page2[0].f2_115[0]", "157");
        fill(fields, "topmostSubform[0].Page2[0].f2_116[0]", "158");
        fill(fields, "topmostSubform[0].Page2[0].f2_117[0]", "159");
        fill(fields, "topmostSubform[0].Page2[0].f2_118[0]", "160");
        fill(fields, "topmostSubform[0].Page2[0].f2_119[0]", "161");
        fill(fields, "topmostSubform[0].Page2[0].f2_120[0]", "162");
        fill(fields, "topmostSubform[0].Page2[0].f2_121[0]", "163");
        fill(fields, "topmostSubform[0].Page2[0].f2_122[0]", "164");
        fill(fields, "topmostSubform[0].Page2[0].f2_123[0]", "165");
        fill(fields, "topmostSubform[0].Page2[0].f2_124[0]", "166");
        fill(fields, "topmostSubform[0].Page2[0].f2_125[0]", "167");
        fill(fields, "topmostSubform[0].Page2[0].f2_126[0]", "168");
        fill(fields, "topmostSubform[0].Page2[0].f2_127[0]", "169");
        fill(fields, "topmostSubform[0].Page2[0].f2_128[0]", "170");
        fill(fields, "topmostSubform[0].Page2[0].f2_129[0]", "171");
        fill(fields, "topmostSubform[0].Page2[0].f2_130[0]", "172");
        fill(fields, "topmostSubform[0].Page2[0].f2_131[0]", "173");
        fill(fields, "topmostSubform[0].Page2[0].f2_132[0]", "174");
        fill(fields, "topmostSubform[0].Page2[0].f2_133[0]", "175");
        fill(fields, "topmostSubform[0].Page2[0].f2_134[0]", "176");
        fill(fields, "topmostSubform[0].Page2[0].f2_135[0]", "177");
        fill(fields, "topmostSubform[0].Page2[0].f2_136[0]", "178");
        fill(fields, "topmostSubform[0].Page2[0].f2_137[0]", "179");
        fill(fields, "topmostSubform[0].Page2[0].f2_138[0]", "180");
        fill(fields, "topmostSubform[0].Page2[0].f2_139[0]", "181");
        fill(fields, "topmostSubform[0].Page2[0].f2_140[0]", "182");
        fill(fields, "topmostSubform[0].Page2[0].f2_141[0]", "183");
        fill(fields, "topmostSubform[0].Page2[0].f2_142[0]", "184");
        fill(fields, "topmostSubform[0].Page2[0].f2_143[0]", "185");
        fill(fields, "topmostSubform[0].Page2[0].f2_144[0]", "186");
        fill(fields, "topmostSubform[0].Page2[0].f2_145[0]", "187");
        fill(fields, "topmostSubform[0].Page2[0].f2_146[0]", "188");
        fill(fields, "topmostSubform[0].Page3[0]", "189");
        fill(fields, "topmostSubform[0].Page3[0].Name_ReadOrder[0]", "190");
        fill(fields, "topmostSubform[0].Page3[0].Name_ReadOrder[0].f1_3[0]", "191");
        fill(fields, "topmostSubform[0].Page3[0].EIN_ReadOrder[0]", "192");
        fill(fields, "topmostSubform[0].Page3[0].EIN_ReadOrder[0].f1_1[0]", "193");
        fill(fields, "topmostSubform[0].Page3[0].EIN_ReadOrder[0].f1_2[0]", "194");
        fill(fields, "topmostSubform[0].Page3[0].f2_1[0]", "195");
        fill(fields, "topmostSubform[0].Page3[0].f1_12[0]", "196");
        fill(fields, "topmostSubform[0].Page3[0].f3_1[0]", "197");
        fill(fields, "topmostSubform[0].Page3[0].f3_2[0]", "198");
        fill(fields, "topmostSubform[0].Page3[0].f3_3[0]", "199");
        fill(fields, "topmostSubform[0].Page3[0].f3_4[0]", "200");
        fill(fields, "topmostSubform[0].Page3[0].f3_5[0]", "201");
        fill(fields, "topmostSubform[0].Page3[0].f3_6[0]", "202");
        fill(fields, "topmostSubform[0].Page3[0].f3_7[0]", "203");
        fill(fields, "topmostSubform[0].Page3[0].f3_8[0]", "204");
        fill(fields, "topmostSubform[0].Page3[0].f3_9[0]", "205");
        fill(fields, "topmostSubform[0].Page3[0].f3_10[0]", "206");
        fill(fields, "topmostSubform[0].Page3[0].f3_11[0]", "207");
        fill(fields, "topmostSubform[0].Page3[0].f3_12[0]", "208");
        fill(fields, "topmostSubform[0].Page3[0].f3_13[0]", "209");
        fill(fields, "topmostSubform[0].Page3[0].f3_14[0]", "210");
        fill(fields, "topmostSubform[0].Page3[0].f3_15[0]", "211");
        fill(fields, "topmostSubform[0].Page3[0].f3_16[0]", "212");
        fill(fields, "topmostSubform[0].Page3[0].f3_17[0]", "213");
        fill(fields, "topmostSubform[0].Page3[0].f3_18[0]", "214");
        fill(fields, "topmostSubform[0].Page3[0].f3_19[0]", "215");
        fill(fields, "topmostSubform[0].Page3[0].f3_20[0]", "216");
        fill(fields, "topmostSubform[0].Page3[0].f3_21[0]", "217");
        fill(fields, "topmostSubform[0].Page3[0].f3_22[0]", "218");
        fill(fields, "topmostSubform[0].Page3[0].f3_23[0]", "219");
        fill(fields, "topmostSubform[0].Page3[0].f3_24[0]", "220");
        fill(fields, "topmostSubform[0].Page3[0].f3_25[0]", "221");
        fill(fields, "topmostSubform[0].Page3[0].f3_26[0]", "222");
        fill(fields, "topmostSubform[0].Page3[0].f3_27[0]", "223");
        fill(fields, "topmostSubform[0].Page3[0].f3_28[0]", "224");
        fill(fields, "topmostSubform[0].Page3[0].f3_29[0]", "225");
        fill(fields, "topmostSubform[0].Page3[0].f3_30[0]", "226");
        fill(fields, "topmostSubform[0].Page3[0].f3_31[0]", "227");
        fill(fields, "topmostSubform[0].Page3[0].f3_32[0]", "228");
        fill(fields, "topmostSubform[0].Page3[0].f3_33[0]", "229");
        fill(fields, "topmostSubform[0].Page3[0].f3_34[0]", "230");
        fill(fields, "topmostSubform[0].Page3[0].f3_35[0]", "231");
        fill(fields, "topmostSubform[0].Page3[0].f3_36[0]", "232");
        fill(fields, "topmostSubform[0].Page3[0].f3_37[0]", "233");
        fill(fields, "topmostSubform[0].Page3[0].f3_38[0]", "234");
        fill(fields, "topmostSubform[0].Page3[0].f3_39[0]", "235");
        fill(fields, "topmostSubform[0].Page3[0].f3_40[0]", "236");
        fill(fields, "topmostSubform[0].Page3[0].f3_41[0]", "237");
        fill(fields, "topmostSubform[0].Page3[0].f3_42[0]", "238");
        fill(fields, "topmostSubform[0].Page3[0].f3_43[0]", "239");
        fill(fields, "topmostSubform[0].Page3[0].f3_44[0]", "240");
        fill(fields, "topmostSubform[0].Page3[0].f3_45[0]", "241");
        fill(fields, "topmostSubform[0].Page3[0].f3_46[0]", "242");
        fill(fields, "topmostSubform[0].Page3[0].f3_47[0]", "243");
        fill(fields, "topmostSubform[0].Page3[0].f3_48[0]", "244");
        fill(fields, "topmostSubform[0].Page3[0].f3_49[0]", "245");
        fill(fields, "topmostSubform[0].Page3[0].f3_50[0]", "246");
        fill(fields, "topmostSubform[0].Page3[0].f3_51[0]", "247");
        fill(fields, "topmostSubform[0].Page3[0].f3_52[0]", "248");
        fill(fields, "topmostSubform[0].Page3[0].f3_53[0]", "249");
        fill(fields, "topmostSubform[0].Page3[0].f3_54[0]", "250");
        fill(fields, "topmostSubform[0].Page3[0].f3_55[0]", "251");
        fill(fields, "topmostSubform[0].Page3[0].f3_56[0]", "252");
        fill(fields, "topmostSubform[0].Page3[0].f3_57[0]", "253");
        fill(fields, "topmostSubform[0].Page3[0].f3_58[0]", "254");
        fill(fields, "topmostSubform[0].Page3[0].f3_59[0]", "255");
        fill(fields, "topmostSubform[0].Page3[0].f3_60[0]", "256");
        fill(fields, "topmostSubform[0].Page3[0].f3_61[0]", "257");
        fill(fields, "topmostSubform[0].Page3[0].f3_62[0]", "258");
        fill(fields, "topmostSubform[0].Page3[0].f3_63[0]", "259");
        fill(fields, "topmostSubform[0].Page3[0].f3_64[0]", "260");
        fill(fields, "topmostSubform[0].Page3[0].f3_65[0]", "261");
        fill(fields, "topmostSubform[0].Page3[0].f3_66[0]", "262");
        fill(fields, "topmostSubform[0].Page3[0].f3_67[0]", "263");
        fill(fields, "topmostSubform[0].Page3[0].f3_68[0]", "264");
        fill(fields, "topmostSubform[0].Page3[0].f3_69[0]", "265");
        fill(fields, "topmostSubform[0].Page3[0].f3_70[0]", "266");
        fill(fields, "topmostSubform[0].Page3[0].f3_71[0]", "267");
        fill(fields, "topmostSubform[0].Page3[0].f3_72[0]", "268");
        fill(fields, "topmostSubform[0].Page3[0].f3_73[0]", "269");
        fill(fields, "topmostSubform[0].Page3[0].f3_74[0]", "270");
        fill(fields, "topmostSubform[0].Page3[0].f3_75[0]", "271");
        fill(fields, "topmostSubform[0].Page3[0].f3_76[0]", "272");
        fill(fields, "topmostSubform[0].Page3[0].c3_1[0]", "273");
        fill(fields, "topmostSubform[0].Page3[0].f3_77[0]", "274");
        fill(fields, "topmostSubform[0].Page3[0].f3_78[0]", "275");
        fill(fields, "topmostSubform[0].Page3[0].f3_79[0]", "276");
        fill(fields, "topmostSubform[0].Page3[0].f3_80[0]", "277");
        fill(fields, "topmostSubform[0].Page3[0].f3_81[0]", "278");
        fill(fields, "topmostSubform[0].Page3[0].f3_82[0]", "279");
        fill(fields, "topmostSubform[0].Page4[0]", "280");
        fill(fields, "topmostSubform[0].Page4[0].Name_ReadOrder[0]", "281");
        fill(fields, "topmostSubform[0].Page4[0].Name_ReadOrder[0].f1_3[0]", "282");
        fill(fields, "topmostSubform[0].Page4[0].EIN_ReadOrder[0]", "283");
        fill(fields, "topmostSubform[0].Page4[0].EIN_ReadOrder[0].f1_1[0]", "284");
        fill(fields, "topmostSubform[0].Page4[0].EIN_ReadOrder[0].f1_2[0]", "285");
        fill(fields, "topmostSubform[0].Page4[0].f2_1[0]", "286");
        fill(fields, "topmostSubform[0].Page4[0].f1_12[0]", "287");
        fill(fields, "topmostSubform[0].Page4[0].f4_1[0]", "288");
        fill(fields, "topmostSubform[0].Page4[0].f4_2[0]", "289");
        fill(fields, "topmostSubform[0].Page4[0].f4_3[0]", "290");
        fill(fields, "topmostSubform[0].Page4[0].f4_4[0]", "291");
        fill(fields, "topmostSubform[0].Page4[0].f4_5[0]", "292");
        fill(fields, "topmostSubform[0].Page4[0].f4_6[0]", "293");
        fill(fields, "topmostSubform[0].Page4[0].f4_7[0]", "294");
        fill(fields, "topmostSubform[0].Page4[0].f4_8[0]", "295");
        fill(fields, "topmostSubform[0].Page4[0].f4_9[0]", "296");
        fill(fields, "topmostSubform[0].Page4[0].f4_10[0]", "297");
        fill(fields, "topmostSubform[0].Page4[0].f4_11[0]", "298");
        fill(fields, "topmostSubform[0].Page4[0].f4_12[0]", "299");
        fill(fields, "topmostSubform[0].Page4[0].f4_13[0]", "300");
        fill(fields, "topmostSubform[0].Page4[0].f4_14[0]", "301");
        fill(fields, "topmostSubform[0].Page4[0].f4_15[0]", "302");
        fill(fields, "topmostSubform[0].Page4[0].f4_16[0]", "303");
        fill(fields, "topmostSubform[0].Page4[0].f4_17[0]", "304");
        fill(fields, "topmostSubform[0].Page4[0].f4_18[0]", "305");
        fill(fields, "topmostSubform[0].Page4[0].f4_19[0]", "306");
        fill(fields, "topmostSubform[0].Page4[0].f4_20[0]", "307");
        fill(fields, "topmostSubform[0].Page4[0].f4_21[0]", "308");
        fill(fields, "topmostSubform[0].Page4[0].f4_22[0]", "309");
        fill(fields, "topmostSubform[0].Page4[0].f4_23[0]", "310");
        fill(fields, "topmostSubform[0].Page4[0].f4_24[0]", "311");
        fill(fields, "topmostSubform[0].Page4[0].f4_25[0]", "312");
        fill(fields, "topmostSubform[0].Page4[0].f4_26[0]", "313");
        fill(fields, "topmostSubform[0].Page4[0].f4_27[0]", "314");
        fill(fields, "topmostSubform[0].Page4[0].f4_28[0]", "315");
        fill(fields, "topmostSubform[0].Page4[0].f4_29[0]", "316");
        fill(fields, "topmostSubform[0].Page4[0].f4_30[0]", "317");
        fill(fields, "topmostSubform[0].Page4[0].f4_31[0]", "318");
        fill(fields, "topmostSubform[0].Page4[0].f4_32[0]", "319");
        fill(fields, "topmostSubform[0].Page4[0].f4_33[0]", "320");
        fill(fields, "topmostSubform[0].Page4[0].f4_34[0]", "321");
        fill(fields, "topmostSubform[0].Page4[0].f4_35[0]", "322");
        fill(fields, "topmostSubform[0].Page4[0].f4_36[0]", "323");
        fill(fields, "topmostSubform[0].Page4[0].f4_37[0]", "324");
        fill(fields, "topmostSubform[0].Page4[0].f4_38[0]", "325");
        fill(fields, "topmostSubform[0].Page4[0].f4_39[0]", "326");
        fill(fields, "topmostSubform[0].Page4[0].f4_40[0]", "327");
        fill(fields, "topmostSubform[0].Page4[0].f4_41[0]", "328");
        fill(fields, "topmostSubform[0].Page4[0].f4_42[0]", "329");
        fill(fields, "topmostSubform[0].Page4[0].f4_43[0]", "330");
        fill(fields, "topmostSubform[0].Page4[0].f4_44[0]", "331");
        fill(fields, "topmostSubform[0].Page4[0].f4_45[0]", "332");
        fill(fields, "topmostSubform[0].Page4[0].f4_46[0]", "333");
        fill(fields, "topmostSubform[0].Page4[0].f4_47[0]", "334");
        fill(fields, "topmostSubform[0].Page4[0].f4_48[0]", "335");
        fill(fields, "topmostSubform[0].Page4[0].f4_49[0]", "336");
        fill(fields, "topmostSubform[0].Page4[0].f4_50[0]", "337");
        fill(fields, "topmostSubform[0].Page4[0].f4_51[0]", "338");
        fill(fields, "topmostSubform[0].Page4[0].f4_52[0]", "339");
        fill(fields, "topmostSubform[0].Page4[0].f4_53[0]", "340");
        fill(fields, "topmostSubform[0].Page4[0].f4_54[0]", "341");
        fill(fields, "topmostSubform[0].Page5[0]", "342");
        fill(fields, "topmostSubform[0].Page5[0].Name_ReadOrder[0]", "343");
        fill(fields, "topmostSubform[0].Page5[0].Name_ReadOrder[0].f1_3[0]", "344");
        fill(fields, "topmostSubform[0].Page5[0].EIN_ReadOrder[0]", "345");
        fill(fields, "topmostSubform[0].Page5[0].EIN_ReadOrder[0].f1_1[0]", "346");
        fill(fields, "topmostSubform[0].Page5[0].EIN_ReadOrder[0].f1_2[0]", "347");
        fill(fields, "topmostSubform[0].Page5[0].f2_1[0]", "348");
        fill(fields, "topmostSubform[0].Page5[0].f1_12[0]", "349");
        fill(fields, "topmostSubform[0].Page5[0].c5_1[0]", "350");
        fill(fields, "topmostSubform[0].Page5[0].c5_2[0]", "351");
        fill(fields, "topmostSubform[0].Page5[0].Line43Entry[0]", "352");
        fill(fields, "topmostSubform[0].Page5[0].Line43Entry[0].f5_1[0]", "353");
        fill(fields, "topmostSubform[0].Page5[0].f5_2[0]", "354");
        fill(fields, "topmostSubform[0].Page5[0].f5_3[0]", "355");
        fill(fields, "topmostSubform[0].Page5[0].f5_4[0]", "356");
        fill(fields, "topmostSubform[0].Page5[0].c5_3[0]", "357");
        fill(fields, "topmostSubform[0].Page5[0].f5_31[0]", "358");
        fill(fields, "topmostSubform[0].Page5[0].f5_5[0]", "359");
        fill(fields, "topmostSubform[0].Page5[0].f5_6[0]", "360");
        fill(fields, "topmostSubform[0].Page5[0].f5_7[0]", "361");
        fill(fields, "topmostSubform[0].Page5[0].f5_8[0]", "362");
        fill(fields, "topmostSubform[0].Page5[0].f5_9[0]", "363");
        fill(fields, "topmostSubform[0].Page5[0].f5_10[0]", "364");
        fill(fields, "topmostSubform[0].Page5[0].f5_11[0]", "365");
        fill(fields, "topmostSubform[0].Page5[0].f5_12[0]", "366");


        form.flattenFields();
        pdfDoc.close();
}

private void fill(Map<String, PdfFormField> fields, String name, String value) {
    PdfFormField field = fields.get(name);
    if (field == null) {
        System.err.println("⚠️ Field not found: " + name);
    } else {
        try {
            field.setValue(value);
        } catch (Exception e) {
            System.err.println("❌ Cannot set value for field: " + name + " | Reason: " + e.getMessage());
        }
    }
}

private String spacedDigits(String value) {
    return value.chars()
            .mapToObj(c -> (char) c + "        ") // 7 пробелов
            .collect(Collectors.joining());

}

}
